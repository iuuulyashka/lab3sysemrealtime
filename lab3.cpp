#include <iostream>
#include <thread>
#include <mutex>
#include <chrono>

using namespace std;

int монеты = 101;
int монеты_боба = 0;
int монеты_тома = 0;
mutex мьютекс;

void раздел_монет(string имя_вора) {
    while (монеты > 0) {
        мьютекс.lock();

        if (монеты > 0) {
            if (имя_вора == "Боб") {
                if (монеты_боба <= монеты_тома) {
                    монеты--;
                    монеты_боба++;
                    cout << "Боб взял монету. У Боба: " << монеты_боба
                        << ", у Тома: " << монеты_тома
                        << ", осталось: " << монеты << endl;
                }
            }
            else {
                if (монеты_тома <= монеты_боба) {
                    монеты--;
                    монеты_тома++;
                    cout << "Том взял монету. У Боба: " << монеты_боба
                        << ", у Тома: " << монеты_тома
                        << ", осталось: " << монеты << endl;
                }
            }
        }

        мьютекс.unlock();
        this_thread::sleep_for(chrono::milliseconds(10));
    }
}

int main() {
    cout << "=== Раздел 101 монеты ===" << endl;
    cout << "Начало дележа..." << endl << endl;

    thread боб(раздел_монет, "Боб");
    thread том(раздел_монет, "Том");

    боб.join();
    том.join();

    cout << endl << "=== Результаты ===" << endl;
    cout << "Боб: " << монеты_боба << " монет" << endl;
    cout << "Том: " << монеты_тома << " монет" << endl;
    cout << "Всего разделено: " << (монеты_боба + монеты_тома) << endl;

    if (монеты_боба + монеты_тома == 101) {
        cout << "Дележ прошел успешно!" << endl;
    }

    system("pause");
    return 0;
}